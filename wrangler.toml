name = "l-exe"
main = "workers/src/index.ts"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# Development settings
[dev]
port = 8787
local_protocol = "http"

# Environment variables (secrets should be set via wrangler secret put)
[vars]
APP_TITLE = "L_EXE"
DOMAIN_SERVER = "https://l-exe.datasloth.workers.dev"
DOMAIN_CLIENT = "https://l-exe-app.pages.dev"
ALLOW_EMAIL_LOGIN = "true"
ALLOW_REGISTRATION = "true"
ALLOW_SOCIAL_LOGIN = "false"
ALLOW_SOCIAL_REGISTRATION = "false"
SESSION_EXPIRY = "1000 * 60 * 15"
REFRESH_TOKEN_EXPIRY = "(1000 * 60 * 60 * 24) * 7"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "l_exe_db"
database_id = "43249e77-8477-41eb-9dad-c552e3b701f9"
migrations_dir = "migrations"

# R2 Storage binding for files (enable R2 in dashboard first)
# [[r2_buckets]]
# binding = "FILES_BUCKET"
# bucket_name = "l-exe-files"

# R2 Storage binding for images (enable R2 in dashboard first)
# [[r2_buckets]]
# binding = "IMAGES_BUCKET"
# bucket_name = "l-exe-images"

# KV Namespace for sessions/cache
[[kv_namespaces]]
binding = "SESSIONS"
id = "8924d602065c4722bcd4b331270b097a"

# KV Namespace for rate limiting
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "0c07717617204ebf875600885d368872"

# Vectorize index for RAG (optional, requires beta access)
# [[vectorize]]
# binding = "VECTORIZE"
# index_name = "l-exe-embeddings"

# AI binding for Workers AI (optional)
# [ai]
# binding = "AI"

# Queue for background jobs (optional)
# [[queues.producers]]
# queue = "l-exe-jobs"
# binding = "JOBS_QUEUE"

# Durable Objects for real-time features (optional)
# [[durable_objects.bindings]]
# name = "CONVERSATIONS"
# class_name = "ConversationDurableObject"

# [[migrations]]
# tag = "v1"
# new_classes = ["ConversationDurableObject"]

# Production environment overrides
[env.production]
vars = { DOMAIN_SERVER = "https://your-domain.com", DOMAIN_CLIENT = "https://your-domain.com" }

# Staging environment
[env.staging]
vars = { DOMAIN_SERVER = "https://staging.your-domain.com", DOMAIN_CLIENT = "https://staging.your-domain.com" }
